# Comparing `tmp/tfrecords-0.2.6-cp39-cp39-win_amd64.whl.zip` & `tmp/tfrecords-0.2.9-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,35 +1,37 @@
-Zip file size: 1115413 bytes, number of entries: 33
--rw-rw-rw-  2.0 fat     5815 b- defN 23-Apr-27 12:03 tfrecords/README.md
--rw-rw-rw-  2.0 fat       69 b- defN 23-Apr-27 12:03 tfrecords/__init__.py
--rw-rw-rw-  2.0 fat       36 b- defN 23-Apr-27 12:03 tfrecords/version_config.py
--rw-rw-rw-  2.0 fat      104 b- defN 23-Apr-27 12:03 tfrecords/lib/__init__.py
--rw-rw-rw-  2.0 fat  2287616 b- defN 23-Apr-27 12:06 tfrecords/lib/tfrecords_cc.pyd
--rw-rw-rw-  2.0 fat      232 b- defN 23-Apr-27 12:03 tfrecords/python/__init__.py
--rw-rw-rw-  2.0 fat       99 b- defN 23-Apr-27 12:03 tfrecords/python/framework/__init__.py
--rw-rw-rw-  2.0 fat     1003 b- defN 23-Apr-27 12:03 tfrecords/python/framework/errors.py
--rw-rw-rw-  2.0 fat    16075 b- defN 23-Apr-27 12:03 tfrecords/python/framework/errors_impl.py
--rw-rw-rw-  2.0 fat      123 b- defN 23-Apr-27 12:03 tfrecords/python/io/__init__.py
--rw-rw-rw-  2.0 fat    28604 b- defN 23-Apr-27 12:03 tfrecords/python/io/file_io.py
--rw-rw-rw-  2.0 fat    27406 b- defN 23-Apr-27 12:03 tfrecords/python/io/file_io_test.py
--rw-rw-rw-  2.0 fat      967 b- defN 23-Apr-27 12:03 tfrecords/python/io/gfile.py
--rw-rw-rw-  2.0 fat     7682 b- defN 23-Apr-27 12:03 tfrecords/python/io/tf_leveldb.py
--rw-rw-rw-  2.0 fat     6108 b- defN 23-Apr-27 12:03 tfrecords/python/io/tf_lmdb.py
--rw-rw-rw-  2.0 fat    11449 b- defN 23-Apr-27 12:03 tfrecords/python/io/tf_record.py
--rw-rw-rw-  2.0 fat    24321 b- defN 23-Apr-27 12:03 tfrecords/python/io/tf_record_test.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Apr-27 12:03 tfrecords/python/util/__init__.py
--rw-rw-rw-  2.0 fat     6636 b- defN 23-Apr-27 12:03 tfrecords/python/util/compat.py
--rw-rw-rw-  2.0 fat     9664 b- defN 23-Apr-27 12:03 tfrecords/python/util/tf_decorator.py
--rw-rw-rw-  2.0 fat    11838 b- defN 23-Apr-27 12:03 tfrecords/python/util/tf_decorator_test.py
--rw-rw-rw-  2.0 fat    14016 b- defN 23-Apr-27 12:03 tfrecords/python/util/tf_export.py
--rw-rw-rw-  2.0 fat     9710 b- defN 23-Apr-27 12:03 tfrecords/python/util/tf_export_test.py
--rw-rw-rw-  2.0 fat    15553 b- defN 23-Apr-27 12:03 tfrecords/python/util/tf_inspect.py
--rw-rw-rw-  2.0 fat    24675 b- defN 23-Apr-27 12:03 tfrecords/python/util/tf_inspect_test.py
--rw-rw-rw-  2.0 fat       77 b- defN 23-Apr-27 12:03 tfrecords/testing/__init__.py
--rw-rw-rw-  2.0 fat     1386 b- defN 23-Apr-27 12:03 tfrecords/testing/demo_leveldb.py
--rw-rw-rw-  2.0 fat     1639 b- defN 23-Apr-27 12:03 tfrecords/testing/demo_lmdb.py
--rw-rw-rw-  2.0 fat     2245 b- defN 23-Apr-27 12:03 tfrecords/testing/demo_record.py
--rw-rw-rw-  2.0 fat     6934 b- defN 23-Apr-27 12:06 tfrecords-0.2.6.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 23-Apr-27 12:06 tfrecords-0.2.6.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       10 b- defN 23-Apr-27 12:06 tfrecords-0.2.6.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     2893 b- defN 23-Apr-27 12:06 tfrecords-0.2.6.dist-info/RECORD
-33 files, 2525085 bytes uncompressed, 1110739 bytes compressed:  56.0%
+Zip file size: 6587000 bytes, number of entries: 35
+-rw-rw-rw-  2.0 fat     8979 b- defN 23-Jul-02 11:26 tfrecords/README.md
+-rw-rw-rw-  2.0 fat       69 b- defN 23-Jul-02 11:26 tfrecords/__init__.py
+-rw-rw-rw-  2.0 fat       36 b- defN 23-Jul-02 11:26 tfrecords/version_config.py
+-rw-rw-rw-  2.0 fat      104 b- defN 23-Jul-02 11:26 tfrecords/lib/__init__.py
+-rw-rw-rw-  2.0 fat 18538496 b- defN 23-Jul-02 11:26 tfrecords/lib/arrow_cc.pyd
+-rw-rw-rw-  2.0 fat  2313216 b- defN 23-Jul-02 11:26 tfrecords/lib/tfrecords_cc.pyd
+-rw-rw-rw-  2.0 fat      255 b- defN 23-Jul-02 11:26 tfrecords/python/__init__.py
+-rw-rw-rw-  2.0 fat       99 b- defN 23-Jul-02 11:26 tfrecords/python/framework/__init__.py
+-rw-rw-rw-  2.0 fat     1003 b- defN 23-Jul-02 11:26 tfrecords/python/framework/errors.py
+-rw-rw-rw-  2.0 fat    16075 b- defN 23-Jul-02 11:26 tfrecords/python/framework/errors_impl.py
+-rw-rw-rw-  2.0 fat      123 b- defN 23-Jul-02 11:26 tfrecords/python/io/__init__.py
+-rw-rw-rw-  2.0 fat    25785 b- defN 23-Jul-02 11:26 tfrecords/python/io/arrow.py
+-rw-rw-rw-  2.0 fat    28567 b- defN 23-Jul-02 11:26 tfrecords/python/io/file_io.py
+-rw-rw-rw-  2.0 fat    27406 b- defN 23-Jul-02 11:26 tfrecords/python/io/file_io_test.py
+-rw-rw-rw-  2.0 fat      701 b- defN 23-Jul-02 11:26 tfrecords/python/io/gfile.py
+-rw-rw-rw-  2.0 fat     7682 b- defN 23-Jul-02 11:26 tfrecords/python/io/tf_leveldb.py
+-rw-rw-rw-  2.0 fat     6101 b- defN 23-Jul-02 11:26 tfrecords/python/io/tf_lmdb.py
+-rw-rw-rw-  2.0 fat    11427 b- defN 23-Jul-02 11:26 tfrecords/python/io/tf_record.py
+-rw-rw-rw-  2.0 fat    24321 b- defN 23-Jul-02 11:26 tfrecords/python/io/tf_record_test.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-02 11:26 tfrecords/python/util/__init__.py
+-rw-rw-rw-  2.0 fat     6636 b- defN 23-Jul-02 11:26 tfrecords/python/util/compat.py
+-rw-rw-rw-  2.0 fat     9664 b- defN 23-Jul-02 11:26 tfrecords/python/util/tf_decorator.py
+-rw-rw-rw-  2.0 fat    14016 b- defN 23-Jul-02 11:26 tfrecords/python/util/tf_export.py
+-rw-rw-rw-  2.0 fat    15675 b- defN 23-Jul-02 11:26 tfrecords/python/util/tf_inspect.py
+-rw-rw-rw-  2.0 fat       77 b- defN 23-Jul-02 11:26 tfrecords/testing/__init__.py
+-rw-rw-rw-  2.0 fat     1057 b- defN 23-Jul-02 11:26 tfrecords/testing/demo_arrow.py
+-rw-rw-rw-  2.0 fat     1338 b- defN 23-Jul-02 11:26 tfrecords/testing/demo_arrow_file.py
+-rw-rw-rw-  2.0 fat     1390 b- defN 23-Jul-02 11:26 tfrecords/testing/demo_leveldb.py
+-rw-rw-rw-  2.0 fat     1650 b- defN 23-Jul-02 11:26 tfrecords/testing/demo_lmdb.py
+-rw-rw-rw-  2.0 fat     1104 b- defN 23-Jul-02 11:26 tfrecords/testing/demo_parquet.py
+-rw-rw-rw-  2.0 fat     2257 b- defN 23-Jul-02 11:26 tfrecords/testing/demo_record.py
+-rw-rw-rw-  2.0 fat    10337 b- defN 23-Jul-02 11:26 tfrecords-0.2.9.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Jul-02 11:26 tfrecords-0.2.9.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       10 b- defN 23-Jul-02 11:26 tfrecords-0.2.9.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     3044 b- defN 23-Jul-02 11:26 tfrecords-0.2.9.dist-info/RECORD
+35 files, 21078800 bytes uncompressed, 6582108 bytes compressed:  68.8%
```

## zipnote {}

```diff
@@ -6,14 +6,17 @@
 
 Filename: tfrecords/version_config.py
 Comment: 
 
 Filename: tfrecords/lib/__init__.py
 Comment: 
 
+Filename: tfrecords/lib/arrow_cc.pyd
+Comment: 
+
 Filename: tfrecords/lib/tfrecords_cc.pyd
 Comment: 
 
 Filename: tfrecords/python/__init__.py
 Comment: 
 
 Filename: tfrecords/python/framework/__init__.py
@@ -24,14 +27,17 @@
 
 Filename: tfrecords/python/framework/errors_impl.py
 Comment: 
 
 Filename: tfrecords/python/io/__init__.py
 Comment: 
 
+Filename: tfrecords/python/io/arrow.py
+Comment: 
+
 Filename: tfrecords/python/io/file_io.py
 Comment: 
 
 Filename: tfrecords/python/io/file_io_test.py
 Comment: 
 
 Filename: tfrecords/python/io/gfile.py
@@ -54,47 +60,47 @@
 
 Filename: tfrecords/python/util/compat.py
 Comment: 
 
 Filename: tfrecords/python/util/tf_decorator.py
 Comment: 
 
-Filename: tfrecords/python/util/tf_decorator_test.py
-Comment: 
-
 Filename: tfrecords/python/util/tf_export.py
 Comment: 
 
-Filename: tfrecords/python/util/tf_export_test.py
+Filename: tfrecords/python/util/tf_inspect.py
 Comment: 
 
-Filename: tfrecords/python/util/tf_inspect.py
+Filename: tfrecords/testing/__init__.py
 Comment: 
 
-Filename: tfrecords/python/util/tf_inspect_test.py
+Filename: tfrecords/testing/demo_arrow.py
 Comment: 
 
-Filename: tfrecords/testing/__init__.py
+Filename: tfrecords/testing/demo_arrow_file.py
 Comment: 
 
 Filename: tfrecords/testing/demo_leveldb.py
 Comment: 
 
 Filename: tfrecords/testing/demo_lmdb.py
 Comment: 
 
+Filename: tfrecords/testing/demo_parquet.py
+Comment: 
+
 Filename: tfrecords/testing/demo_record.py
 Comment: 
 
-Filename: tfrecords-0.2.6.dist-info/METADATA
+Filename: tfrecords-0.2.9.dist-info/METADATA
 Comment: 
 
-Filename: tfrecords-0.2.6.dist-info/WHEEL
+Filename: tfrecords-0.2.9.dist-info/WHEEL
 Comment: 
 
-Filename: tfrecords-0.2.6.dist-info/top_level.txt
+Filename: tfrecords-0.2.9.dist-info/top_level.txt
 Comment: 
 
-Filename: tfrecords-0.2.6.dist-info/RECORD
+Filename: tfrecords-0.2.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## tfrecords/README.md

```diff
@@ -1,191 +1,346 @@
 tfrecords
 ## simplify and transplant the tfrecord and table
 
 ### update information
 ```text
+    2023-07-01:  Add arrow parquet
     2022-10-30:  Add lmdb leveldb read and writer and add record batch write
     2022-10-17:  Add shared memory for record to read mode with more accelerated Reading.
     2022-02-01:  simplify and transplant the tfrecord dataset
 ```
 
 ### 1. record read and write demo , with_share_memory flags will Accelerated Reading
 
 ```python
 # -*- coding: utf-8 -*-
 # @Time    : 2022/9/8 15:49
 
 import tfrecords
+
 options = tfrecords.TFRecordOptions(compression_type=tfrecords.TFRecordCompressionType.NONE)
+
+
 def test_write(filename, N=3, context='aaa'):
     with tfrecords.TFRecordWriter(filename, options=options) as file_writer:
         batch_data = []
         for i in range(N):
             d = context + '____' + str(i)
             batch_data.append(d)
             if (i + 1) % 100 == 0:
                 file_writer.write_batch(batch_data)
                 batch_data.clear()
         if len(batch_data):
             file_writer.write_batch(batch_data)
             batch_data.clear()
 
+
 def test_record_iterator(example_paths):
     print('test_record_iterator')
     for example_path in example_paths:
-        iterator = tfrecords.tf_record_iterator(example_path, options=options,skip_bytes=0,with_share_memory=True)
+        iterator = tfrecords.tf_record_iterator(example_path, options=options, skip_bytes=0, with_share_memory=True)
         offset_list = iterator.read_offsets(0)
         count = iterator.read_count(0)
         print(count)
         num = 0
         for iter in iterator:
             num += 1
             print(iter)
 
+
 def test_random_reader(example_paths):
     print('test_random_reader')
     for example_path in example_paths:
-        file_reader = tfrecords.tf_record_random_reader(example_path, options=options,with_share_memory=True)
+        file_reader = tfrecords.tf_record_random_reader(example_path, options=options, with_share_memory=True)
         last_pos = 0
         while True:
             try:
-                x,pos = file_reader.read(last_pos)
-                print(x,pos)
+                x, pos = file_reader.read(last_pos)
+                print(x, pos)
                 last_pos = pos
 
             except Exception as e:
                 break
 
+
 def test_random_reader2(example_paths):
     print('test_random_reader2')
     for example_path in example_paths:
-        file_reader = tfrecords.tf_record_random_reader(example_path, options=options,with_share_memory=True)
+        file_reader = tfrecords.tf_record_random_reader(example_path, options=options, with_share_memory=True)
         skip_bytes = 0
         offset_list = file_reader.read_offsets(skip_bytes)
-        for offset,length in offset_list:
+        for offset, length in offset_list:
             x, _ = file_reader.read(offset)
             print(x)
 
-test_write('d:/example.tfrecords0',3,'file0')
+
+test_write('d:/example.tfrecords0', 3, 'file0')
 
 example_paths = tfrecords.glob('d:/example.tfrecords*')
 print(example_paths)
 test_record_iterator(example_paths)
 print()
 test_random_reader(example_paths)
 print()
 test_random_reader2(example_paths)
 print()
 ```
 
-### 2. leveldb read and write demo 
+### 2. leveldb read and write demo
+
 ```python
 # -*- coding: utf-8 -*-
 # @Time    : 2022/9/8 15:49
 
 from tfrecords import LEVELDB
+
 db_path = 'd:/example_leveldb'
+
+
 def test_write(db_path):
     options = LEVELDB.LeveldbOptions(create_if_missing=True, error_if_exists=False)
-    file_writer = LEVELDB.Leveldb(db_path,options)
+    file_writer = LEVELDB.Leveldb(db_path, options)
 
-    keys,values = [],[]
+    keys, values = [], []
     for i in range(30):
         keys.append(b"input_" + str(i).encode())
         keys.append(b"label_" + str(i).encode())
         values.append(b"xiaoming" + str(i).encode())
         values.append(b"zzs" + str(i).encode())
         if (i + 1) % 1000 == 0:
-            file_writer.put_batch(keys,values)
+            file_writer.put_batch(keys, values)
             keys.clear()
             values.clear()
     if len(keys):
         file_writer.put_batch(keys, values)
         keys.clear()
         values.clear()
 
     file_writer.close()
+
+
 def test_read(db_path):
     options = LEVELDB.LeveldbOptions(create_if_missing=False, error_if_exists=False)
-    reader = LEVELDB.Leveldb(db_path,options)
+    reader = LEVELDB.Leveldb(db_path, options)
 
     def show():
         it = reader.get_iterater(reverse=False)
         i = 0
         for item in it:
-            print(i,item)
+            print(i, item)
             i += 1
 
     def test_find(key):
         value = reader.get(key)
         print('find', type(value), value)
 
     show()
 
     test_find(b'input_0')
     test_find(b'input_5')
     test_find(b'input_10')
 
     reader.close()
 
+
 test_write(db_path)
 test_read(db_path)
 ```
 
 
-### 3. lmdb read and write demo 
+### 3. lmdb read and write demo
+
 ```python
 # -*- coding: utf-8 -*-
 # @Time    : 2022/9/8 15:49
 
 from tfrecords import LMDB
+
 db_path = 'd:/example_lmdb'
+
+
 def test_write(db_path):
-    options = LMDB.LmdbOptions(env_open_flag = 0,
-                env_open_mode = 0o664, # 8进制表示
-                txn_flag = 0,
-                dbi_flag = 0,
-                put_flag = 0)
-    file_writer = LMDB.Lmdb(db_path,options,map_size=1024 * 1024 * 10)
+    options = LMDB.LmdbOptions(env_open_flag=0,
+                               env_open_mode=0o664,  # 8进制表示
+                               txn_flag=0,
+                               dbi_flag=0,
+                               put_flag=0)
+    file_writer = LMDB.Lmdb(db_path, options, map_size=1024 * 1024 * 10)
     keys, values = [], []
     for i in range(30):
         keys.append(b"input_" + str(i).encode())
         keys.append(b"label_" + str(i).encode())
         values.append(b"xiaoming_" + str(i).encode())
         values.append(b"zzs_" + str(i).encode())
         if (i + 1) % 1000 == 0:
             file_writer.put_batch(keys, values)
             keys.clear()
             values.clear()
     if len(keys):
         file_writer.put_batch(keys, values)
     file_writer.close()
+
+
 def test_read(db_path):
-    options = LMDB.LmdbOptions( env_open_flag = LMDB.LmdbFlag.MDB_RDONLY,
-                env_open_mode = 0o664, # 8进制表示
-                txn_flag = LMDB.LmdbFlag.MDB_RDONLY,
-                dbi_flag = 0,
-                put_flag = 0)
-    reader = LMDB.Lmdb(db_path,options,map_size=0)
+    options = LMDB.LmdbOptions(env_open_flag=LMDB.LmdbFlag.MDB_RDONLY,
+                               env_open_mode=0o664,  # 8进制表示
+                               txn_flag = 0, # LMDB.LmdbFlag.MDB_RDONLY
+                               dbi_flag=0,
+                               put_flag=0)
+    reader = LMDB.Lmdb(db_path, options, map_size=0)
 
     def show():
         it = reader.get_iterater(reverse=False)
         i = 0
         for item in it:
-            print(i,item)
+            print(i, item)
             i += 1
 
-
     def test_find(key):
         value = reader.get(key)
         print('find', type(value), value)
 
     show()
     test_find('input0')
     test_find('input5')
     test_find(b'input10')
     reader.close()
 
+
 test_write(db_path)
 test_read(db_path)
 
-```
+```
+
+
+### 4. arrow demo
+
+### Stream
+```python
+
+from tfrecords.python.io.arrow import IPC_Writer,IPC_StreamReader,arrow
+
+path_file = "d:/tmp/data.arrow"
+
+def test_write():
+    schema = arrow.schema([
+        arrow.field('id', arrow.int32()),
+        arrow.field('text', arrow.utf8())
+    ])
+
+    a = arrow.Int32Builder()
+    a.AppendValues([0,1,4])
+    a = a.Finish().Value()
+
+    b = arrow.StringBuilder()
+    b.AppendValues(["aaaa","你是谁","张三"])
+    b = b.Finish().Value()
+
+    table = arrow.Table.Make(schema = schema,arrays=[a,b])
+    fs = IPC_Writer(path_file,schema,with_stream = True)
+    fs.write_table(table)
+    fs.close()
+
+def test_read():
+    fs = IPC_StreamReader(path_file)
+    table = fs.read_all()
+    fs.close()
+    print(table)
+
+    col = table.GetColumnByName('text')
+    text_list = col.chunk(0)
+    for i in range(text_list.length()):
+        x = text_list.Value(i)
+        print(type(x), x)
+
+
+test_write()
+test_read()
+```
+
+### file
+```python
+from tfrecords.python.io.arrow import IPC_Writer,IPC_StreamReader,IPC_MemoryMappedFileReader,arrow
+
+path_file = "d:/tmp/data.arrow"
+
+def test_write():
+    schema = arrow.schema([
+        arrow.field('id', arrow.int32()),
+        arrow.field('text', arrow.utf8())
+    ])
+
+    a = arrow.Int32Builder()
+    a.AppendValues([0,1,4])
+    a = a.Finish().Value()
+
+    b = arrow.StringBuilder()
+    b.AppendValues(["aaaa","你是谁","张三"])
+    b = b.Finish().Value()
+
+    table = arrow.Table.Make(schema = schema,arrays=[a,b])
+    fs = IPC_Writer(path_file,schema,with_stream = False)
+    fs.write_table(table)
+    fs.close()
+
+
+def test_read():
+
+    fs = IPC_MemoryMappedFileReader(path_file)
+    for i in range(fs.num_record_batches()):
+        batch = fs.read_batch(i)
+        print(batch)
+    fs.close()
+
+
+test_write()
+test_read()
+```
+
+
+### 4. parquet demo
+
+
+```python
+from tfrecords.python.io.arrow import ParquetWriter,IPC_StreamReader,ParquetReader,arrow
+path_file = "d:/tmp/data.parquet"
+
+def test_write():
+    schema = arrow.schema([
+        arrow.field('id', arrow.int32()),
+        arrow.field('text', arrow.utf8())
+    ])
+
+    a = arrow.Int32Builder()
+    a.AppendValues([0, 1, 4, 5])
+    a = a.Finish().Value()
+
+    b = arrow.StringBuilder()
+    b.AppendValues(["aaaa", "你是谁", "张三", "李赛"])
+    b = b.Finish().Value()
+
+    table = arrow.Table.Make(schema=schema, arrays=[a, b])
+
+    fs = ParquetWriter(path_file, schema)
+    fs.write_table(table)
+    fs.close()
+
+def test_read():
+
+    fs = ParquetReader(path_file,options=dict(buffer_size=2))
+    table = fs.read_table()
+    fs.close()
+    table = table.Flatten().Value()
+    print(table)
+
+    col = table.GetColumnByName('text')
+    text_list = col.chunk(0)
+    for i in range(text_list.length()):
+        x = text_list.Value(i)
+        print(type(x),x)
+
+
+test_write()
+test_read()
+```
+
+
```

## tfrecords/python/__init__.py

```diff
@@ -3,8 +3,9 @@
 # @FileName: __init__.py.py
 #
 
 from .framework import *
 from .io import *
 from .io import tf_lmdb as LMDB
 from .io import tf_leveldb as LEVELDB
-from .io import tf_record as RECORD
+from .io import tf_record as RECORD
+from .io import arrow
```

## tfrecords/python/io/file_io.py

```diff
@@ -16,17 +16,17 @@
 import binascii
 import os
 from posixpath import join as urljoin
 import uuid
 
 import six
 
-from tfrecords.python.util import compat
-from tfrecords.python.util.tf_export import tf_export
-from tfrecords.lib import tfrecords_cc as _pywrap_file_io
+from ..util import compat
+from ..util.tf_export import tf_export
+from ...lib import tfrecords_cc as _pywrap_file_io
 
 # A good default block size depends on the system in question.
 # A somewhat conservative default chosen here.
 _DEFAULT_BLOCK_SIZE = 16 * 1024 * 1024
 
 
 class FileIO(object):
```

## tfrecords/python/io/gfile.py

```diff
@@ -1,18 +1,18 @@
 # @Time    : 2022/9/21 19:48
 # @Author  : tk
 # @FileName: gfile.py
 
-from tfrecords.python.io.file_io import copy_v2 as copy
-from tfrecords.python.io.file_io import create_dir_v2 as mkdir
-from tfrecords.python.io.file_io import delete_file_v2 as remove
-from tfrecords.python.io.file_io import delete_recursively_v2 as rmtree
-from tfrecords.python.io.file_io import file_exists_v2 as exists
-from tfrecords.python.io.file_io import get_matching_files_v2 as glob
-from tfrecords.python.io.file_io import get_registered_schemes
-from tfrecords.python.io.file_io import is_directory_v2 as isdir
-from tfrecords.python.io.file_io import join
-from tfrecords.python.io.file_io import list_directory_v2 as listdir
-from tfrecords.python.io.file_io import recursive_create_dir_v2 as makedirs
-from tfrecords.python.io.file_io import rename_v2 as rename
-from tfrecords.python.io.file_io import stat_v2 as stat
-from tfrecords.python.io.file_io import walk_v2 as walk
+from .file_io import copy_v2 as copy
+from .file_io import create_dir_v2 as mkdir
+from .file_io import delete_file_v2 as remove
+from .file_io import delete_recursively_v2 as rmtree
+from .file_io import file_exists_v2 as exists
+from .file_io import get_matching_files_v2 as glob
+from .file_io import get_registered_schemes
+from .file_io import is_directory_v2 as isdir
+from .file_io import join
+from .file_io import list_directory_v2 as listdir
+from .file_io import recursive_create_dir_v2 as makedirs
+from .file_io import rename_v2 as rename
+from .file_io import stat_v2 as stat
+from .file_io import walk_v2 as walk
```

## tfrecords/python/io/tf_lmdb.py

```diff
@@ -13,15 +13,15 @@
 # limitations under the License.
 # ==============================================================================
 
 """For reading and writing TFTables files."""
 import os
 import typing
 from tfrecords.python.util import compat
-from tfrecords.lib import tfrecords_cc as _pywrap_db_io
+from ...lib import tfrecords_cc as _pywrap_db_io
 
 
 __all__ = [
   'LmdbOptions',
   'LmdbIterater',
   'Lmdb',
   'LmdbFlag',
```

## tfrecords/python/io/tf_record.py

```diff
@@ -12,16 +12,16 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
 """For reading and writing TFRecords files."""
 
 
-from tfrecords.python.util import compat
-from tfrecords.lib import tfrecords_cc as _pywrap_record_io
+from ..util import compat
+from ...lib import tfrecords_cc as _pywrap_record_io
 
 __all__ = [
   'TFRecordCompressionType',
   'TFRecordOptions',
   'tf_record_iterator',
   'tf_record_random_reader',
   'TFRecordWriter',
```

## tfrecords/python/util/tf_inspect.py

```diff
@@ -31,17 +31,21 @@
   return _inspect.signature(
       tf_decorator.unwrap(obj)[1], follow_wrapped=follow_wrapped)
 
 
 Parameter = _inspect.Parameter
 Signature = _inspect.Signature
 
-ArgSpec = _inspect.ArgSpec
 
 
+if hasattr(_inspect, 'ArgSpec'):
+  ArgSpec = _inspect.ArgSpec
+else:
+  ArgSpec = collections.namedtuple('ArgSpec', 'args varargs keywords defaults')
+
 if hasattr(_inspect, 'FullArgSpec'):
   FullArgSpec = _inspect.FullArgSpec  # pylint: disable=invalid-name
 else:
   FullArgSpec = collections.namedtuple('FullArgSpec', [
       'args', 'varargs', 'varkw', 'defaults', 'kwonlyargs', 'kwonlydefaults',
       'annotations'
   ])
```

## tfrecords/testing/demo_leveldb.py

```diff
@@ -1,12 +1,12 @@
 # -*- coding: utf-8 -*-
 # @Time    : 2022/9/8 15:49
 
 from tfrecords import LEVELDB
-db_path = 'd:/example_leveldb'
+db_path = 'd:/tmp/example_leveldb'
 def test_write(db_path):
     options = LEVELDB.LeveldbOptions(create_if_missing=True, error_if_exists=False)
     file_writer = LEVELDB.Leveldb(db_path,options)
 
     keys,values = [],[]
     for i in range(30):
         keys.append(b"input_" + str(i).encode())
```

## tfrecords/testing/demo_lmdb.py

```diff
@@ -1,12 +1,12 @@
 # -*- coding: utf-8 -*-
 # @Time    : 2022/9/8 15:49
 
 from tfrecords import LMDB
-db_path = 'd:/example_lmdb'
+db_path = 'd:/tmp/example_lmdb'
 def test_write(db_path):
     options = LMDB.LmdbOptions(env_open_flag = 0,
                 env_open_mode = 0o664, # 8进制表示
                 txn_flag = 0,
                 dbi_flag = 0,
                 put_flag = 0)
     file_writer = LMDB.Lmdb(db_path,options,map_size=1024 * 1024 * 10)
@@ -22,34 +22,32 @@
             values.clear()
     if len(keys):
         file_writer.put_batch(keys, values)
     file_writer.close()
 def test_read(db_path):
     options = LMDB.LmdbOptions( env_open_flag = LMDB.LmdbFlag.MDB_RDONLY,
                 env_open_mode = 0o664, # 8进制表示
-                txn_flag = LMDB.LmdbFlag.MDB_RDONLY,
+                txn_flag = 0, # LMDB.LmdbFlag.MDB_RDONLY
                 dbi_flag = 0,
                 put_flag = 0)
-    reader = LMDB.Lmdb(db_path,options,map_size=0)
+    reader = LMDB.Lmdb(db_path,options,map_size= 0)
 
     def show():
         it = reader.get_iterater(reverse=False)
         i = 0
         for item in it:
             print(i,item)
             i += 1
-
-
-    def test_find(key):
-        value = reader.get(key)
-        print('find', type(value), value)
-
     show()
 
+    # def test_find(key):
+    #     value = reader.get(key)
+    #     print('find', type(value), value)
     # test_find('input0')
     # test_find('input5')
     # test_find(b'input10')
 
     reader.close()
 
+
 test_write(db_path)
 test_read(db_path)
```

## tfrecords/testing/demo_record.py

```diff
@@ -15,50 +15,50 @@
         if len(batch_data):
             file_writer.write_batch(batch_data)
             batch_data.clear()
 
 def test_record_iterator(example_paths):
     print('test_record_iterator')
     for example_path in example_paths:
-        iterator = tfrecords.tf_record_iterator(example_path, options=options,skip_bytes=0,with_share_memory=True)
+        iterator = tfrecords.tf_record_iterator(example_path, options=options, skip_bytes=0, with_share_memory=True)
         offset_list = iterator.read_offsets(0)
         count = iterator.read_count(0)
         print(count)
         num = 0
         for iter in iterator:
             num += 1
             print(iter)
 
 def test_random_reader(example_paths):
     print('test_random_reader')
     for example_path in example_paths:
-        file_reader = tfrecords.tf_record_random_reader(example_path, options=options,with_share_memory=True)
+        file_reader = tfrecords.tf_record_random_reader(example_path, options=options, with_share_memory=True)
         last_pos = 0
         while True:
             try:
                 x,pos = file_reader.read(last_pos)
                 print(x,pos)
                 last_pos = pos
 
             except Exception as e:
                 break
 
 def test_random_reader2(example_paths):
     print('test_random_reader2')
     for example_path in example_paths:
-        file_reader = tfrecords.tf_record_random_reader(example_path, options=options,with_share_memory=True)
+        file_reader = tfrecords.tf_record_random_reader(example_path, options=options, with_share_memory=True)
         skip_bytes = 0
         offset_list = file_reader.read_offsets(skip_bytes)
         for offset,length in offset_list:
             x, _ = file_reader.read(offset)
             print(x)
 
-test_write('d:/example.tfrecords0',2,'file0')
+test_write('d:/tmp/example.tfrecords0',2,'file0')
 
-example_paths = tfrecords.glob('d:/example.tfrecords*')
+example_paths = tfrecords.glob('d:/tmp/example.tfrecords*')
 print(example_paths)
 test_record_iterator(example_paths)
 print()
 test_random_reader(example_paths)
 print()
 test_random_reader2(example_paths)
 print()
```

## Comparing `tfrecords-0.2.6.dist-info/RECORD` & `tfrecords-0.2.9.dist-info/RECORD`

 * *Files 20% similar despite different names*

```diff
@@ -1,33 +1,35 @@
-tfrecords/README.md,sha256=FVl1XLDQrEuOEW6OdYej-yIDgvqmLFwe7D7iEAi-lCs,5815
+tfrecords/README.md,sha256=xjZbPWXYT0tJy-1QXRPQU9bLY-i6m4mVAQDzZNZChE0,8979
 tfrecords/__init__.py,sha256=fDDq-a0ha5So6pFBTVkT9uZFTNNKZtdM9uY4JvyHM9k,69
 tfrecords/version_config.py,sha256=5mvBjbfRGGadH3fQih-qpfGPjL1Enc5tW2sf1qHroW4,36
 tfrecords/lib/__init__.py,sha256=flMtCQdSl76L4s9qfuWTgSkY9N7MYAnXgGxyROW1bzM,104
-tfrecords/lib/tfrecords_cc.pyd,sha256=nhVS0t-17g7f2z3sXyfRKCOPvOSPr__PCO2FW-qeu_4,2287616
-tfrecords/python/__init__.py,sha256=xIbbMqEvDxxr1zwJPvetQnvA50Qhb947lsS4pjuaKCI,232
+tfrecords/lib/arrow_cc.pyd,sha256=m6wdIpoHnV0Q9Y0wSlOa9ngu7sWsPX1brXQ2URyAvxI,18538496
+tfrecords/lib/tfrecords_cc.pyd,sha256=16GyQAUjRWRerA5kKp2ZbfGEkCWLwI4eUePP0OJHSzo,2313216
+tfrecords/python/__init__.py,sha256=dXyiJJWGgTpIa91FuHoXqYLV0pukHDL6IMgmuniu5Sc,255
 tfrecords/python/framework/__init__.py,sha256=_MVHfS1sIzl7wG47YxwykJfG4uoLX1scclSaaWosCTc,99
 tfrecords/python/framework/errors.py,sha256=kQQDvEgy2aryQf7QwEx7fPRSkea5YTSpF5KVNB1CVFg,1003
 tfrecords/python/framework/errors_impl.py,sha256=Kv6t_OqKqPvW28W44tcbzoq5W4aQ8K7nl4BhtvuWECQ,16075
 tfrecords/python/io/__init__.py,sha256=_1HH7zU199XVY5GrX6I0Ttl7-PzMZApeewPo4SK-hxU,123
-tfrecords/python/io/file_io.py,sha256=LzFkwz0h_hvzUfDyV5Tmat_WxoSE13d3Ncli-jVmsIo,28604
+tfrecords/python/io/arrow.py,sha256=61dGWQINa0jwDXHbCH3fVJ0xeP3Vd0xC4lBwo7GAM5k,25785
+tfrecords/python/io/file_io.py,sha256=FpP_vynumskuWR-kZSSuCjw-23D_iI5Km7fgIs5k4Ok,28567
 tfrecords/python/io/file_io_test.py,sha256=cSLybCcCAD2sOvH8S199_4B4kj-hC1uZ4sraOdcIGMI,27406
-tfrecords/python/io/gfile.py,sha256=6rrOx4VFBsf-iDsaX68PmYfATaUMNxfe32VSjSbZwEU,967
+tfrecords/python/io/gfile.py,sha256=eYjfHXEH47ejq7bxvLSi4lh6ZS_mDfEN6fKHdzxF244,701
 tfrecords/python/io/tf_leveldb.py,sha256=--LTkox2hVdTEJru-7yC5uE-_htX0GZsdC_eGn4yKBQ,7682
-tfrecords/python/io/tf_lmdb.py,sha256=7RRqIblEDJJCvsu6UuGiK54154bL1uOaP3HMHW-KHfc,6108
-tfrecords/python/io/tf_record.py,sha256=VuP67xvTo7LZzQKR7XZDLAAXRxmmJtGDr86WVfsD6To,11449
+tfrecords/python/io/tf_lmdb.py,sha256=FXO5ImH8JcXI4AEElh_DEFvCbUg6akNtWuB7Kl_Uk5M,6101
+tfrecords/python/io/tf_record.py,sha256=T4CVOR_yUykjVsiYmii_amrrJ-k1ipnzLgNU3q1lCsg,11427
 tfrecords/python/io/tf_record_test.py,sha256=udv2EmA5eEayeEyrKJf8GEMlGWO5819WRFF9yqJVM_0,24321
 tfrecords/python/util/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tfrecords/python/util/compat.py,sha256=qyBkxViFNC6f2BHG0Os5wShuEwkQVWrrgBH_XWSavss,6636
 tfrecords/python/util/tf_decorator.py,sha256=QBUn4Xsw2Q8mwKC-78DbKNPi7qFhhozrT0efxb16v0A,9664
-tfrecords/python/util/tf_decorator_test.py,sha256=FrdvgEF5ivO1t1DTyGTFzQqZbPrN4tGEgvMqFD8aOyc,11838
 tfrecords/python/util/tf_export.py,sha256=KEaG3T1IACUL3f-pvYY_Mlhli7yLoQSi1uMQTcs8hrw,14016
-tfrecords/python/util/tf_export_test.py,sha256=s4IV-o1Ublq4FI5S-nIxgNSdHUWLo_0cnNxbgrefrKM,9710
-tfrecords/python/util/tf_inspect.py,sha256=VdXwC_zBXYKLYX6dE3T3R0DvdcvKXW_enh9C2qJbmnI,15553
-tfrecords/python/util/tf_inspect_test.py,sha256=MfDVyWyAlX3KFppc0oC9_4P_QVHS7u0HhjfNrBc8Cn8,24675
+tfrecords/python/util/tf_inspect.py,sha256=Sq8jpuYurHYIzgUq82lfS8Dv8FWMgh2tiXfuMd7n3wg,15675
 tfrecords/testing/__init__.py,sha256=PkC-PFNHeqM4Jzr7SgS3jUKcx5hTGhXk2RAY0fiJy1k,77
-tfrecords/testing/demo_leveldb.py,sha256=J98BZDUjee_T7azEGiLGr53jzmfJZExK_jwyEFW0CM8,1386
-tfrecords/testing/demo_lmdb.py,sha256=Qtb03Ra5Z3K_YXaSjEYqrN9WKYxwofHrLJ0BDbCZN4A,1639
-tfrecords/testing/demo_record.py,sha256=0VU87ogsgUGSRqNatcYBvFTj73Vy0HFPEo87LIzK0IU,2245
-tfrecords-0.2.6.dist-info/METADATA,sha256=WdlX28GZpGQPo-AJWNUWdRT1OW7PcKQi47CBfLpKViE,6934
-tfrecords-0.2.6.dist-info/WHEEL,sha256=MRZ_p7RU4olp1XL4U2EYLkuYikriaVRqXBoKVLH_OSE,100
-tfrecords-0.2.6.dist-info/top_level.txt,sha256=9krMlLgZcGidjiMhgm9zyjo03vJRdFBDOdxobAEb0ps,10
-tfrecords-0.2.6.dist-info/RECORD,,
+tfrecords/testing/demo_arrow.py,sha256=DKfUR-iM3uHVI_j3Ap4tjcX-zkIDpTm4O2QB01KPI-I,1057
+tfrecords/testing/demo_arrow_file.py,sha256=pcgL1hQGqXielZ07cb3d9NRTUfnArkBS05znoc4Di48,1338
+tfrecords/testing/demo_leveldb.py,sha256=hMGgmZqtjCmw4d61twehQmD1V0oCwfyXgkaD1hjwTQs,1390
+tfrecords/testing/demo_lmdb.py,sha256=VOuRMR0xeKy1ogA7KuW_fp7zeMcxtZIhY0bU8uzHEp4,1650
+tfrecords/testing/demo_parquet.py,sha256=wSWKVVMjt9LTr6Dn4ji4D8oCkhUnyd6XYbTaHs0BjHc,1104
+tfrecords/testing/demo_record.py,sha256=YetIRGADaiLaJDMPQC7Wh3wg3r2WqfM74cQT6g-9XqE,2257
+tfrecords-0.2.9.dist-info/METADATA,sha256=27LYiq2SGjnX94dqISftYpM0sEmbASFK62xhbL4RxKU,10337
+tfrecords-0.2.9.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
+tfrecords-0.2.9.dist-info/top_level.txt,sha256=9krMlLgZcGidjiMhgm9zyjo03vJRdFBDOdxobAEb0ps,10
+tfrecords-0.2.9.dist-info/RECORD,,
```

