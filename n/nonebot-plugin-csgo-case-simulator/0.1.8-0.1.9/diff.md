# Comparing `tmp/nonebot-plugin-csgo-case-simulator-0.1.8.tar.gz` & `tmp/nonebot-plugin-csgo-case-simulator-0.1.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "nonebot-plugin-csgo-case-simulator-0.1.8.tar", max compression
+gzip compressed data, was "nonebot-plugin-csgo-case-simulator-0.1.9.tar", max compression
```

## Comparing `nonebot-plugin-csgo-case-simulator-0.1.8.tar` & `nonebot-plugin-csgo-case-simulator-0.1.9.tar`

### file list

```diff
@@ -1,13 +1,13 @@
--rw-r--r--   0        0        0     1062 2023-05-06 19:37:08.273216 nonebot-plugin-csgo-case-simulator-0.1.8/LICENSE
--rw-r--r--   0        0        0     4537 2023-05-08 01:58:39.508153 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/__init__.py
--rw-r--r--   0        0        0    14492 2023-05-08 01:42:00.277080 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/background3.jpeg
--rw-r--r--   0        0        0     5327 2023-05-08 01:55:42.619431 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/crates.py
--rw-r--r--   0        0        0  3886748 2023-05-07 01:22:58.975435 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/font/font.ttf
--rw-r--r--   0        0        0   367810 2023-05-07 23:51:29.826342 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/json/cases.json
--rw-r--r--   0        0        0  1027515 2023-05-07 23:51:29.814018 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/json/skins.json
--rw-r--r--   0        0        0   321996 2023-05-07 23:51:29.834274 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/json/souvenir.json
--rw-r--r--   0        0        0     1955 2023-05-08 01:55:47.310489 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/skins.py
--rw-r--r--   0        0        0     3994 2023-05-08 01:40:15.727005 nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/utils.py
--rw-r--r--   0        0        0      516 2023-05-08 01:54:47.051876 nonebot-plugin-csgo-case-simulator-0.1.8/pyproject.toml
--rw-r--r--   0        0        0      828 2023-05-08 02:00:34.639507 nonebot-plugin-csgo-case-simulator-0.1.8/setup.py
--rw-r--r--   0        0        0      546 2023-05-08 02:00:34.639640 nonebot-plugin-csgo-case-simulator-0.1.8/PKG-INFO
+-rw-r--r--   0        0        0     1062 2023-05-06 19:37:08.273216 nonebot-plugin-csgo-case-simulator-0.1.9/LICENSE
+-rw-r--r--   0        0        0     3861 2023-05-08 08:26:58.638863 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/__init__.py
+-rw-r--r--   0        0        0    14492 2023-05-08 01:42:00.277080 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/background3.jpeg
+-rw-r--r--   0        0        0     3821 2023-05-08 08:21:44.818989 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/crates.py
+-rw-r--r--   0        0        0  3886748 2023-05-07 01:22:58.975435 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/font/font.ttf
+-rw-r--r--   0        0        0   367811 2023-05-08 06:31:00.481523 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/json/cases.json
+-rw-r--r--   0        0        0  1027515 2023-05-07 23:51:29.814018 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/json/skins.json
+-rw-r--r--   0        0        0   321996 2023-05-07 23:51:29.834274 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/json/souvenir.json
+-rw-r--r--   0        0        0     1178 2023-05-08 08:22:42.534363 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/skins.py
+-rw-r--r--   0        0        0     3849 2023-05-08 08:22:27.623469 nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/utils.py
+-rw-r--r--   0        0        0      516 2023-05-08 08:28:27.278784 nonebot-plugin-csgo-case-simulator-0.1.9/pyproject.toml
+-rw-r--r--   0        0        0      828 2023-05-08 08:31:58.483985 nonebot-plugin-csgo-case-simulator-0.1.9/setup.py
+-rw-r--r--   0        0        0      546 2023-05-08 08:31:58.484123 nonebot-plugin-csgo-case-simulator-0.1.9/PKG-INFO
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/LICENSE` & `nonebot-plugin-csgo-case-simulator-0.1.9/LICENSE`

 * *Files identical despite different names*

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/__init__.py` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/__init__.py`

 * *Files 8% similar despite different names*

```diff
@@ -20,25 +20,14 @@
     )
     crates.cases = res[0]
     crates.souvenirs = res[1]
     skins.skins = res[2]
 
 asyncio.run(get_all_json())
 
-rarities = {
-    "工业级": 1,
-    "军规级": 2,
-    "受限": 3,
-    "保密": 4,
-    "隐秘": 5,
-    "非凡": 6,
-}
-
-rarities_reverse = {value: key for key, value in rarities.items()}
-
 crate_opening = on_command("open", priority=5)
 list_cases = on_command("cases", priority=5)
 list_souvenir = on_command("svs", priority=5)
 search_skin = on_command("s_skin", priority=5)
 help = on_command("help", priority=5)
 
 
@@ -63,66 +52,56 @@
         svs_list_str += f"{sv}\n"
     await list_souvenir.finish(f"{svs_list_str}")
 
 
 @help.handle()
 async def handle_help():
     await help.finish(
-        """
-    开箱指令：    
-    /open [数量] [箱子名] 开箱    
-    /cases 查看所有箱子    
-    /svs 查看所有纪念包    
-    /s_skin [皮肤名] 搜索皮肤    
-    /help 查看帮助    
-    """
+        """开箱指令:
+/open [数量] [箱子名] 开箱
+/cases 查看所有箱子
+/svs 查看所有纪念包
+/s_skin [皮肤名] 搜索皮肤
+/help 查看帮助"""
     )
 
-# @radom_case.handle()
-# async def handle_random_case():
-#     case = cases.get_random_case()
-#     await radom_case.send(f"正在开启{case['name']}...")
-#     item = cases.open_case(case["id"])
-#     skin = skins.get_skins(item["id"])
-#     await radom_case.finish(get_skink_message(skin))
-
 
 @crate_opening.handle()
 async def handle_open_crate(event: MessageEvent, args: Message = CommandArg()):
     (amount, name) = extract_args(args)
     if name:
         crate = get_crate(name)
         if crate:
             if not crate["contains"]:
                 await crate_opening.finish("箱子里面是空的")
-            img_base64 = await utils.url_to_b64(crate["image"])
+            img_base64 = await utils.img_from_url(crate["image"])
             await crate_opening.send(MessageSegment.image(img_base64)+f"正在开启{amount}个{crate['name']}...")
             items = crates.open_crate_multiple(
                 crate, amount
             )
             opened_skins = []
             for item in items:
                 skin = skins.get_skins(item["name"])
                 opened_skins.append(skin)
             image = await utils.merge_images(opened_skins)
-            await crate_opening.finish(MessageSegment.image(image))
+            await crate_opening.finish(MessageSegment.reply(event.message_id) + MessageSegment.image(image))
         else:
             await crate_opening.finish("箱子不存在")
     else:
         await crate_opening.finish("请输入箱子名称")
 
 
 @search_skin.handle()
 async def handle_search_skin(args: Message = CommandArg()):
     if skin_name := args.extract_plain_text().strip():
         found_skin_list = skins.search_skin(skin_name)
         if len(found_skin_list) == 0:
             await search_skin.finish("没找到捏")
         for skin in found_skin_list:
-            img_base64 = await utils.url_to_b64(skin["image"])
+            img_base64 = await utils.img_from_url(skin["image"])
             await search_skin.send(MessageSegment.image(img_base64)+f"找到饰品{skin['name']}")
     else:
         await search_skin.finish("请输入皮肤名称")
 
 
 def extract_args(args: Message = CommandArg()):
     arg_list = args.extract_plain_text().split(" ")
@@ -137,12 +116,7 @@
         return amount, crate_name
     else:
         return 1, None
 
 
 def get_crate(name: str):
     return crates.get_case_by_name(name) or crates.get_souvenir_by_name(name)
-
-
-def get_skink_message(skin: dict):
-    return (MessageSegment.image(skin["image"]) +
-            f"""获得 {skin['rarity']}\n{skin['name']}\n磨损度{skin['wear_rating']}""")
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/background3.jpeg` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/background3.jpeg`

 * *Files identical despite different names*

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/font/font.ttf` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/font/font.ttf`

 * *Files identical despite different names*

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/json/cases.json` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/json/cases.json`

 * *Files 0% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9998918905168906%*

 * *Differences: {'1': "{'contains': {0: {'rarity': '军规级'}, 6: {'rarity': '保密'}, 7: {'rarity': '保密'}}}",*

 * * '12': "{'contains': {0: {'rarity': '军规级'}}}"}*

```diff
@@ -357,15 +357,15 @@
         "type": "Case"
     },
     {
         "contains": [
             {
                 "id": "skin-1049280",
                 "name": "M4A4 | \u6e10\u53d8\u6591\u7eb9",
-                "rarity": "\u5de5\u4e1a\u7ea7"
+                "rarity": "\u519b\u89c4\u7ea7"
             },
             {
                 "id": "skin-1770180",
                 "name": "MAG-7 | \u8bb0\u5fc6\u788e\u7247",
                 "rarity": "\u519b\u89c4\u7ea7"
             },
             {
@@ -387,20 +387,20 @@
                 "id": "skin-2359944",
                 "name": "P250 | \u72c2\u91ce\u98de\u6e85",
                 "rarity": "\u53d7\u9650"
             },
             {
                 "id": "skin-458808",
                 "name": "AK-47 | \u7ea2\u8272\u5c42\u538b\u677f",
-                "rarity": "\u53d7\u9650"
+                "rarity": "\u4fdd\u5bc6"
             },
             {
                 "id": "skin-590520",
                 "name": "AWP | *\u5623*",
-                "rarity": "\u53d7\u9650"
+                "rarity": "\u4fdd\u5bc6"
             },
             {
                 "id": "skin-1245808",
                 "name": "P90 | \u55b5\u4e4b\u840c\u6740",
                 "rarity": "\u9690\u79d8"
             }
         ],
@@ -4039,15 +4039,15 @@
         "type": "Case"
     },
     {
         "contains": [
             {
                 "id": "skin-263740",
                 "name": "\u683c\u6d1b\u514b 18 \u578b | \u4ea1\u8005\u4e4b\u5bdd",
-                "rarity": "\u5de5\u4e1a\u7ea7"
+                "rarity": "\u519b\u89c4\u7ea7"
             },
             {
                 "id": "skin-919108",
                 "name": "M249 | \u7cfb\u7edf\u9501\u5b9a",
                 "rarity": "\u519b\u89c4\u7ea7"
             },
             {
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/json/skins.json` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/json/skins.json`

 * *Files identical despite different names*

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/json/souvenir.json` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/json/souvenir.json`

 * *Files identical despite different names*

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/skins.py` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/skins.py`

 * *Files 19% similar despite different names*

```diff
@@ -14,45 +14,26 @@
         # async with httpx.AsyncClient() as client:
         #     return await client.get(self.skins_api)
         with open(f"{JSON_DIR}/skins.json", 'rb') as f:
             data = f.read()
             return json.loads(data)
 
     def get_skins(self, name: str) -> dict:
-        # print(name)
         for skin in self.skins:
             if skin["name"] == name:
                 wear_rating = round(
                     random.uniform(skin["min_float"], skin["max_float"]), 5
                 )
                 return {
                     "id": skin["id"],
                     "name": skin["name"],
                     "image": skin["image"],
                     "rarity": skin["rarity"],
                     "wear_rating": wear_rating,
                 }
-        # return self.check_if_wrong_name(name)
-
-    # temp fix
-    # def check_if_wrong_name(self, name: str):
-    #     if name.find("M4A1 消音型") != -1:
-    #         skin_name = name.replace("M4A1 消音型", "M4A4")
-    #         for skin in self.skins:
-    #             if skin["name"] == skin_name:
-    #                 wear_rating = round(
-    #                     random.uniform(skin["min_float"], skin["max_float"]), 5
-    #                 )
-    #                 return {
-    #                     "id": skin["id"],
-    #                     "name": name,
-    #                     "image": skin["image"],
-    #                     "rarity": skin["rarity"],
-    #                     "wear_rating": wear_rating,
-    #                 }
 
     def search_skin(self, skin_name: str) -> dict:
         found_skin_list = []
         for skin in self.skins:
             if skin["pattern"].find(skin_name.lower()) != -1:
                 found_skin_list.append(skin)
         return found_skin_list
```

#### encoding

```diff
@@ -1 +1 @@
-utf-8
+us-ascii
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/nonebot-plugin-csgo-case-simulator/utils.py` & `nonebot-plugin-csgo-case-simulator-0.1.9/nonebot-plugin-csgo-case-simulator/utils.py`

 * *Files 6% similar despite different names*

```diff
@@ -98,26 +98,24 @@
                     100 + height * row + (row - 1) * info_height + 100
                 ),
                 f"磨损: {items[i]['wear_rating']}",
                 font=font,
                 fill=font_color
             )
 
-        return self.img_to_b64(canvas)
+        return self.img_from_PIL(canvas)
 
     async def download_image(self, url):
         async with httpx.AsyncClient() as client:
             response = await client.get(url)
             img = Image.open(BytesIO(response.content))
             return img
 
-    def img_to_b64(self, pic: Image.Image) -> str:
+    def img_from_PIL(self, pic: Image.Image) -> str:
         buf = BytesIO()
         pic.save(buf, format="PNG")
-        base64_str = base64.b64encode(buf.getbuffer()).decode()
-        return "base64://" + base64_str
+        return buf.getvalue()
 
-    async def url_to_b64(self, url: str) -> str:
+    async def img_from_url(self, url: str) -> str:
         async with httpx.AsyncClient() as client:
             response = await client.get(url)
-            base64_str = base64.b64encode(response.content).decode()
-            return "base64://" + base64_str
+            return response.content
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/pyproject.toml` & `nonebot-plugin-csgo-case-simulator-0.1.9/pyproject.toml`

 * *Files 23% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "nonebot-plugin-csgo-case-simulator"
-version = "0.1.8"
+version = "0.1.9"
 description = "a nonebot based csgo case simulator"
 authors = ["Roy <lyt2980999208@gmail.com>"]
 license = "MIT"
 packages = [{ include = "nonebot-plugin-csgo-case-simulator" }]
 
 [tool.poetry.dependencies]
 python = "^3.10"
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/setup.py` & `nonebot-plugin-csgo-case-simulator-0.1.9/setup.py`

 * *Files 11% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 ['Pillow>=9.5.0,<10.0.0',
  'httpx>=0.24.0,<0.25.0',
  'nonebot-adapter-onebot>=2.2.3,<3.0.0',
  'nonebot2>=2.0.0-rc.4,<3.0.0']
 
 setup_kwargs = {
     'name': 'nonebot-plugin-csgo-case-simulator',
-    'version': '0.1.8',
+    'version': '0.1.9',
     'description': 'a nonebot based csgo case simulator',
     'long_description': None,
     'author': 'Roy',
     'author_email': 'lyt2980999208@gmail.com',
     'maintainer': None,
     'maintainer_email': None,
     'url': None,
```

### Comparing `nonebot-plugin-csgo-case-simulator-0.1.8/PKG-INFO` & `nonebot-plugin-csgo-case-simulator-0.1.9/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: nonebot-plugin-csgo-case-simulator
-Version: 0.1.8
+Version: 0.1.9
 Summary: a nonebot based csgo case simulator
 License: MIT
 Author: Roy
 Author-email: lyt2980999208@gmail.com
 Requires-Python: >=3.10,<4.0
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3
```

